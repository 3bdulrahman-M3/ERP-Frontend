<app-layout pageTitle="ููุญุฉ ุงูุชุญูู">
<div *ngIf="currentRoute === '/dashboard'" class="p-4">
  <div class="space-y-4">
    <!-- Welcome Header -->
    <div class="relative overflow-hidden bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 rounded-2xl shadow-xl p-6 text-white">
      <div class="relative z-10">
        <div class="flex items-center justify-between flex-wrap gap-4">
          <div>
            <h1 class="text-3xl font-bold mb-2">ูุฑุญุจุงู {{ currentUser?.name }} ๐</h1>
            <p class="text-white/90 text-sm">
              {{ currentUser?.role === 'admin' ? 'ููุญุฉ ุชุญูู ุงููุฏูุฑ' : 'ููุญุฉ ุชุญูู ุงูุทุงูุจ' }}
            </p>
          </div>
          <div class="flex items-center gap-3">
            <div class="bg-white/20 backdrop-blur-sm rounded-xl px-4 py-2">
              <span [class]="currentUser?.role === 'admin' ? 'text-yellow-300' : 'text-cyan-300'" class="text-lg font-bold">
                {{ currentUser?.role === 'admin' ? '๐' : '๐' }}
              </span>
              <span class="mr-2 font-semibold">{{ currentUser?.role === 'admin' ? 'ูุฏูุฑ' : 'ุทุงูุจ' }}</span>
            </div>
          </div>
        </div>
      </div>
      <div class="absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full blur-2xl"></div>
      <div class="absolute bottom-0 left-0 w-24 h-24 bg-white/10 rounded-full blur-2xl"></div>
    </div>
    
    <!-- User Info - Compact -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
      <div class="bg-white rounded-xl shadow-md p-4 border border-gray-100">
        <p class="text-xs text-gray-500 mb-1">ุงูุงุณู</p>
        <p class="text-base font-semibold text-gray-800">{{ currentUser?.name }}</p>
      </div>
      <div class="bg-white rounded-xl shadow-md p-4 border border-gray-100">
        <p class="text-xs text-gray-500 mb-1">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</p>
        <p class="text-sm font-semibold text-gray-800 truncate">{{ currentUser?.email }}</p>
      </div>
      <div class="bg-white rounded-xl shadow-md p-4 border border-gray-100">
        <p class="text-xs text-gray-500 mb-1">ุงูุญุงูุฉ</p>
        <span [class]="currentUser?.isActive ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'" 
              class="inline-flex items-center px-2 py-1 rounded-full text-xs font-semibold">
          <span class="w-1.5 h-1.5 rounded-full mr-1.5" [class.bg-green-500]="currentUser?.isActive" [class.bg-red-500]="!currentUser?.isActive"></span>
          {{ currentUser?.isActive ? 'ูุดุท' : 'ุบูุฑ ูุดุท' }}
        </span>
      </div>
    </div>

    <!-- Quick Stats - Admin Only -->
    <div *ngIf="currentUser?.role === 'admin'" class="grid grid-cols-2 lg:grid-cols-4 gap-3">
      <!-- Total Students -->
      <div class="bg-white rounded-xl shadow-md p-4 border-l-4 border-blue-500 hover:shadow-lg transition-shadow">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-xs text-gray-500 mb-1">ุฅุฌูุงูู ุงูุทูุงุจ</p>
            <p class="text-2xl font-bold text-gray-800">
              <span *ngIf="!isLoadingStats">{{ totalStudents }}</span>
              <span *ngIf="isLoadingStats" class="inline-block w-6 h-6 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"></span>
            </p>
          </div>
          <div class="text-3xl">๐</div>
        </div>
      </div>

      <!-- Total Rooms -->
      <div class="bg-white rounded-xl shadow-md p-4 border-l-4 border-cyan-500 hover:shadow-lg transition-shadow">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-xs text-gray-500 mb-1">ุฅุฌูุงูู ุงูุบุฑู</p>
            <p class="text-2xl font-bold text-gray-800">
              <span *ngIf="!isLoadingStats">{{ totalRooms }}</span>
              <span *ngIf="isLoadingStats" class="inline-block w-6 h-6 border-2 border-cyan-500 border-t-transparent rounded-full animate-spin"></span>
            </p>
          </div>
          <div class="text-3xl">๐</div>
        </div>
      </div>

      <!-- Available Rooms -->
      <div class="bg-white rounded-xl shadow-md p-4 border-l-4 border-green-500 hover:shadow-lg transition-shadow">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-xs text-gray-500 mb-1">ุงูุบุฑู ุงููุชุงุญุฉ</p>
            <p class="text-2xl font-bold text-gray-800">
              <span *ngIf="!isLoadingStats">{{ availableRooms }}</span>
              <span *ngIf="isLoadingStats" class="inline-block w-6 h-6 border-2 border-green-500 border-t-transparent rounded-full animate-spin"></span>
            </p>
          </div>
          <div class="text-3xl">โ</div>
        </div>
      </div>

      <!-- Occupied Rooms -->
      <div class="bg-white rounded-xl shadow-md p-4 border-l-4 border-purple-500 hover:shadow-lg transition-shadow">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-xs text-gray-500 mb-1">ุงูุบุฑู ุงููุดุบููุฉ</p>
            <p class="text-2xl font-bold text-gray-800">
              <span *ngIf="!isLoadingStats">{{ occupiedRooms }}</span>
              <span *ngIf="isLoadingStats" class="inline-block w-6 h-6 border-2 border-purple-500 border-t-transparent rounded-full animate-spin"></span>
            </p>
          </div>
          <div class="text-3xl">๐๏ธ</div>
        </div>
      </div>
    </div>

    <!-- Student Info Cards -->
    <div *ngIf="currentUser?.role === 'student'" class="grid grid-cols-1 md:grid-cols-2 gap-3">
      <!-- Check-in/out Status -->
      <div class="bg-white rounded-xl shadow-md p-4 border border-gray-100">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-3">
            <div class="bg-green-100 rounded-lg p-3">
              <span class="text-2xl">๐</span>
            </div>
            <div>
              <p class="text-xs text-gray-500 mb-1">ุญุงูุฉ ุงูุฏุฎูู/ุงูุฎุฑูุฌ</p>
              <p *ngIf="isLoadingStatus" class="text-sm font-semibold text-gray-400">ุฌุงุฑู ุงูุชุญููู...</p>
              <div *ngIf="!isLoadingStatus" class="flex items-center gap-2">
                <span [class]="checkInOutStatus?.isCheckedIn ? 'w-2 h-2 bg-green-500 rounded-full' : 'w-2 h-2 bg-red-500 rounded-full'"></span>
                <span class="text-base font-bold text-gray-800">
                  {{ checkInOutStatus?.isCheckedIn ? 'ุฏุงุฎู ุงูุณูู' : 'ุฎุงุฑุฌ ุงูุณูู' }}
                </span>
              </div>
            </div>
          </div>
        </div>
        <div *ngIf="checkInOutStatus && checkInOutStatus.checkInTime" class="mt-3 pt-3 border-t border-gray-100">
          <p class="text-xs text-gray-500 mb-1">ุขุฎุฑ ุฏุฎูู</p>
          <p class="text-sm font-semibold text-gray-700">{{ formatDateTime(checkInOutStatus.checkInTime) }}</p>
        </div>
      </div>

      <!-- Kitchen Status -->
      <div class="bg-white rounded-xl shadow-md p-4 border border-gray-100">
        <div class="flex items-center justify-between mb-3">
          <div class="flex items-center gap-3">
            <div class="bg-orange-100 rounded-lg p-3">
              <span class="text-2xl">๐ฝ๏ธ</span>
            </div>
            <div>
              <p class="text-xs text-gray-500 mb-1">ุญุงูุฉ ุงููุทุจุฎ</p>
              <span *ngIf="isLoadingKitchen" class="text-sm font-semibold text-gray-400">ุฌุงุฑู ุงูุชุญููู...</span>
              <span *ngIf="!isLoadingKitchen && kitchenStatus?.isOpen" 
                    class="inline-flex items-center px-2 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-700">
                <span class="w-1.5 h-1.5 bg-green-500 rounded-full mr-1.5"></span>
                ููุชูุญ
              </span>
              <span *ngIf="!isLoadingKitchen && !kitchenStatus?.isOpen" 
                    class="inline-flex items-center px-2 py-1 rounded-full text-xs font-semibold bg-red-100 text-red-700">
                <span class="w-1.5 h-1.5 bg-red-500 rounded-full mr-1.5"></span>
                ูุบูู
              </span>
            </div>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-2">
          <!-- Countdown Timer -->
          <div *ngIf="currentUser?.role === 'student' && (countdownTimer || isLoadingKitchen)" class="bg-gradient-to-r from-orange-500 to-orange-600 rounded-lg p-2.5 text-white">
            <p class="text-xs font-semibold mb-1.5 text-center">ุงูุนุฏ ุงูุชูุงุฒูู ูููุฌุจุฉ ุงููุงุฏูุฉ</p>
            <div *ngIf="isLoadingKitchen" class="text-center py-2">
              <p class="text-xs opacity-90">ุฌุงุฑู ุงูุชุญููู...</p>
            </div>
            <div *ngIf="!isLoadingKitchen && countdownTimer" class="flex items-center justify-center gap-1.5">
              <div class="text-center">
                <p class="text-base font-bold">{{ padNumber(countdownTimer.hours) }}</p>
                <p class="text-xs opacity-90">ุณุงุนุฉ</p>
              </div>
              <span class="text-base font-bold">:</span>
              <div class="text-center">
                <p class="text-base font-bold">{{ padNumber(countdownTimer.minutes) }}</p>
                <p class="text-xs opacity-90">ุฏูููุฉ</p>
              </div>
              <span class="text-base font-bold">:</span>
              <div class="text-center">
                <p class="text-base font-bold">{{ padNumber(countdownTimer.seconds) }}</p>
                <p class="text-xs opacity-90">ุซุงููุฉ</p>
              </div>
            </div>
            <div *ngIf="!isLoadingKitchen && !countdownTimer" class="text-center py-2">
              <p class="text-xs opacity-90">ูุง ุชูุฌุฏ ูุฌุจุฉ ูุงุฏูุฉ</p>
            </div>
          </div>
          <div *ngIf="nextMealTime" class="bg-gray-50 rounded-lg p-2">
            <p class="text-xs text-gray-500 mb-1">
              <span *ngIf="kitchenStatus?.isOpen">ุฅุบูุงู</span>
              <ng-container *ngIf="!kitchenStatus?.isOpen && kitchenStatus?.nextMeal as nextMeal">
                <span>{{ mealNames[nextMeal.name] }}</span>
              </ng-container>
            </p>
            <p class="text-sm font-bold text-gray-800">{{ nextMealTime }}</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
</app-layout>

