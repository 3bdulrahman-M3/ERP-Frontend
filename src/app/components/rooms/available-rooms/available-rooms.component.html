<app-layout pageTitle="Available Rooms">
  <div class="p-6 animate-fade-in">
    <!-- Header -->
    <div class="mb-6">
      <h2 class="text-4xl font-bold gradient-text">Available Rooms</h2>
      <p class="text-gray-600 mt-2">Rooms that match your preferences</p>
    </div>

    <!-- Success Message -->
    <div *ngIf="successMessage" class="mb-4 p-4 bg-green-50 border-l-4 border-green-500 rounded-lg animate-scale-in flex items-center gap-3">
      <svg class="w-5 h-5 text-green-600 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <p class="text-sm font-semibold text-green-800">{{ successMessage }}</p>
    </div>

    <!-- Error Message -->
    <div *ngIf="errorMessage" class="mb-4 p-4 bg-red-50 border-l-4 border-red-500 rounded-lg animate-scale-in flex items-center gap-3">
      <svg class="w-5 h-5 text-red-600 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <p class="text-sm font-semibold text-red-800">{{ errorMessage }}</p>
    </div>

    <!-- Loading -->
    <div *ngIf="isLoading" class="flex justify-center items-center py-12">
      <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-gray-700"></div>
    </div>

    <!-- Rooms Grid -->
    <div *ngIf="!isLoading && rooms.length > 0" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6">
      <div
        *ngFor="let room of rooms"
        class="bg-white rounded-2xl shadow-xl overflow-hidden border border-gray-100 hover:shadow-2xl transition-all duration-300"
      >
        <!-- Room Image -->
        <div class="w-full h-48 bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center relative overflow-hidden">
          <img 
            *ngIf="getRoomImage(room) !== null"
            [src]="getImageUrl(getRoomImage(room)!)" 
            [alt]="'Room ' + room.roomNumber" 
            class="w-full h-full object-cover"
            (error)="onImageError($event)"
            loading="lazy"
          />
          <!-- Placeholder for rooms without images -->
          <div *ngIf="getRoomImage(room) === null" class="text-center text-gray-400">
            <svg class="w-16 h-16 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
            </svg>
            <p class="text-xs">No Image</p>
          </div>
        </div>
        
        <!-- Request Status Banner - At the top -->
        <div
          *ngIf="room.hasPendingRequest"
          class="bg-yellow-50 border-b-2 border-yellow-400 px-4 py-3 flex items-center gap-2"
        >
          <svg class="w-5 h-5 text-yellow-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          <span class="text-sm font-semibold text-yellow-800">Request Pending</span>
        </div>
        <div
          *ngIf="room.requestStatus === 'accepted'"
          class="bg-green-50 border-b-2 border-green-500 px-4 py-3 flex items-center gap-2"
        >
          <svg class="w-5 h-5 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          <span class="text-sm font-semibold text-green-800">Request Accepted ‚úì</span>
        </div>
        <div
          *ngIf="room.requestStatus === 'rejected'"
          class="bg-red-50 border-b-2 border-red-500 px-4 py-3 flex items-center gap-2"
        >
          <svg class="w-5 h-5 text-red-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          <span class="text-sm font-semibold text-red-800">Request Rejected</span>
        </div>
        <div
          *ngIf="room.availableBeds === 0 && !room.hasPendingRequest && room.requestStatus !== 'accepted' && room.requestStatus !== 'rejected'"
          class="bg-gray-50 border-b-2 border-gray-400 px-4 py-3 flex items-center gap-2"
        >
          <svg class="w-5 h-5 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636" />
          </svg>
          <span class="text-sm font-semibold text-gray-700">No Beds Available</span>
        </div>

        <div class="p-6">
          <!-- Room Header -->
          <div class="flex justify-between items-start mb-4">
            <div>
              <h3 class="text-2xl font-bold text-gray-900 mb-1">Room {{ room.roomNumber }}</h3>
              <p *ngIf="room.buildingInfo" class="text-sm text-gray-600">{{ room.buildingInfo.name }}</p>
              <p *ngIf="room.floor !== null" class="text-sm text-gray-600">Floor {{ room.floor }}</p>
            </div>
            <span
              [class]="'px-3 py-1 rounded-full text-xs font-semibold ' + getStatusBadgeClass(room.status)"
            >
              {{ getStatusText(room.status) }}
            </span>
          </div>

          <!-- Room Details -->
          <div class="space-y-3 mb-4">
            <div class="flex justify-between items-center py-2 border-b border-gray-100">
              <span class="text-sm text-gray-600 flex items-center gap-2">
                <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                </svg>
                Room Type:
              </span>
              <span class="text-sm font-semibold text-gray-900">{{ getRoomTypeText(room.roomType) }}</span>
            </div>
            <div class="flex justify-between items-center py-2 border-b border-gray-100">
              <span class="text-sm text-gray-600 flex items-center gap-2">
                <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4" />
                </svg>
                Total Beds:
              </span>
              <span class="text-sm font-semibold text-gray-900">{{ room.totalBeds }}</span>
            </div>
            <div class="flex justify-between items-center py-2 border-b border-gray-100">
              <span class="text-sm text-gray-600 flex items-center gap-2">
                <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                Available Beds:
              </span>
              <span class="text-sm font-semibold text-green-600">{{ room.availableBeds }}</span>
            </div>
            <div *ngIf="room.roomType === 'single' && room.roomPrice" class="flex justify-between items-center py-2 border-b border-gray-100">
              <span class="text-sm text-gray-600 flex items-center gap-2">
                <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                Price:
              </span>
              <span class="text-sm font-semibold text-blue-600">${{ room.roomPrice }}</span>
            </div>
            <div *ngIf="room.roomType === 'shared' && room.bedPrice" class="flex justify-between items-center py-2 border-b border-gray-100">
              <span class="text-sm text-gray-600 flex items-center gap-2">
                <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                Bed Price:
              </span>
              <span class="text-sm font-semibold text-blue-600">${{ room.bedPrice }}</span>
            </div>
          </div>

          <!-- Services -->
          <div *ngIf="room.services && room.services.length > 0" class="mb-4">
            <p class="text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2">
              <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
              </svg>
              Services:
            </p>
            <div class="flex flex-wrap gap-2">
              <span
                *ngFor="let service of room.services"
                class="px-3 py-1 bg-blue-50 text-blue-700 rounded-lg text-xs font-semibold border border-blue-200"
              >
                {{ service.name }}
              </span>
            </div>
          </div>

          <!-- Description -->
          <p *ngIf="room.description" class="text-sm text-gray-600 mb-4 line-clamp-2">{{ room.description }}</p>

          <!-- Request Button -->
          <button
            *ngIf="!room.hasPendingRequest && room.availableBeds > 0 && room.requestStatus !== 'accepted' && room.requestStatus !== 'rejected'"
            (click)="openRequestModal(room)"
            class="w-full px-4 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl font-semibold hover:from-blue-700 hover:to-blue-800 transition-all duration-200 shadow-md hover:shadow-lg flex items-center justify-center gap-2"
          >
            <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
            </svg>
            Submit Request
          </button>
        </div>
      </div>
    </div>

    <!-- Empty State -->
    <div *ngIf="!isLoading && rooms.length === 0" class="text-center py-12">
      <div class="text-6xl mb-4">üè†</div>
      <p class="text-xl text-gray-600 mb-2">No rooms available</p>
      <p class="text-sm text-gray-500">No rooms match your preferences at the moment</p>
    </div>

    <!-- Pagination -->
    <div *ngIf="!isLoading && totalPages > 1" class="flex justify-center items-center gap-2 mt-6">
      <button
        (click)="loadRooms(currentPage - 1)"
        [disabled]="currentPage === 1"
        class="px-4 py-2 bg-white border border-gray-300 rounded-lg font-semibold text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"
      >
        Previous
      </button>
      <span class="px-4 py-2 text-gray-700">
        Page {{ currentPage }} of {{ totalPages }}
      </span>
      <button
        (click)="loadRooms(currentPage + 1)"
        [disabled]="currentPage === totalPages"
        class="px-4 py-2 bg-white border border-gray-300 rounded-lg font-semibold text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"
      >
        Next
      </button>
    </div>

    <!-- Request Modal -->
    <div
      *ngIf="showRequestModal"
      class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 animate-fade-in p-4"
      (click)="closeRequestModal()"
    >
      <div
        class="bg-white rounded-2xl shadow-2xl p-6 max-w-md w-full mx-4 animate-scale-in"
        (click)="$event.stopPropagation()"
      >
        <div class="flex items-center justify-between mb-6">
          <h3 class="text-2xl font-bold text-gray-900 flex items-center gap-2">
            <svg class="w-6 h-6 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
            </svg>
            Submit Room Request
          </h3>
          <button
            (click)="closeRequestModal()"
            class="text-gray-400 hover:text-gray-600 transition-colors"
          >
            <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
        
        <div *ngIf="selectedRoom" class="mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200">
          <div class="flex items-center gap-2 mb-2">
            <svg class="w-5 h-5 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
            </svg>
            <p class="text-sm font-semibold text-blue-900">Room: <span class="text-blue-700">{{ selectedRoom.roomNumber }}</span></p>
          </div>
          <p *ngIf="selectedRoom.buildingInfo" class="text-sm text-blue-700 flex items-center gap-2">
            <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
            </svg>
            Building: <span class="font-semibold">{{ selectedRoom.buildingInfo.name }}</span>
          </p>
        </div>
        
        <div class="mb-6">
          <label class="block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2">
            <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
            </svg>
            Notes (Optional)
          </label>
          <textarea
            [(ngModel)]="requestNotes"
            rows="4"
            class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition text-sm"
            placeholder="Add any additional notes or special requests..."
          ></textarea>
        </div>
        
        <div class="flex gap-3">
          <button
            (click)="submitRequest()"
            [disabled]="isLoading"
            class="flex-1 px-4 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl font-semibold hover:from-blue-700 hover:to-blue-800 transition-all duration-200 disabled:opacity-50 shadow-md hover:shadow-lg flex items-center justify-center gap-2"
          >
            <svg *ngIf="!isLoading" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
            </svg>
            <svg *ngIf="isLoading" class="animate-spin w-5 h-5" fill="none" viewBox="0 0 24 24">
              <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
              <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            {{ isLoading ? 'Sending...' : 'Submit Request' }}
          </button>
          <button
            (click)="closeRequestModal()"
            [disabled]="isLoading"
            class="flex-1 px-4 py-3 bg-gray-100 text-gray-700 rounded-xl font-semibold hover:bg-gray-200 transition-all duration-200 disabled:opacity-50 border border-gray-300"
          >
            Cancel
          </button>
        </div>
      </div>
    </div>

    <!-- Images Modal -->
    <div
      *ngIf="showImagesModal && selectedRoomImages.length > 0"
      class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 animate-fade-in"
      (click)="closeImagesModal()"
    >
      <div
        class="bg-white rounded-2xl shadow-2xl max-w-4xl w-full mx-4 animate-scale-in relative"
        (click)="$event.stopPropagation()"
      >
        <!-- Close Button -->
        <button
          (click)="closeImagesModal()"
          class="absolute top-4 right-4 z-10 bg-white/90 hover:bg-white text-gray-800 rounded-full p-2 shadow-lg transition-colors"
        >
          <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>

        <!-- Image Slider -->
        <div class="relative">
          <div class="overflow-hidden rounded-t-2xl">
            <div class="flex transition-transform duration-500 ease-in-out" [style.transform]="'translateX(-' + (currentImageIndex * 100) + '%)'">
              <div *ngFor="let image of selectedRoomImages" class="min-w-full">
                <img 
                  [src]="getImageUrl(image)" 
                  [alt]="'Room Image ' + (currentImageIndex + 1)" 
                  class="w-full h-96 object-contain bg-gray-100"
                  (error)="onImageError($event)"
                >
              </div>
            </div>
          </div>

          <!-- Navigation Arrows -->
          <button
            *ngIf="selectedRoomImages.length > 1"
            (click)="previousImage()"
            class="absolute left-4 top-1/2 transform -translate-y-1/2 bg-white/90 hover:bg-white text-gray-800 p-3 rounded-full shadow-lg transition-colors z-10"
          >
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
            </svg>
          </button>
          <button
            *ngIf="selectedRoomImages.length > 1"
            (click)="nextImage()"
            class="absolute right-4 top-1/2 transform -translate-y-1/2 bg-white/90 hover:bg-white text-gray-800 p-3 rounded-full shadow-lg transition-colors z-10"
          >
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
          </button>

          <!-- Image Indicators -->
          <div *ngIf="selectedRoomImages.length > 1" class="absolute bottom-4 left-1/2 transform -translate-x-1/2 flex gap-2 z-10">
            <button
              *ngFor="let img of selectedRoomImages; let i = index"
              (click)="goToImage(i)"
              [ngClass]="i === currentImageIndex ? 'bg-white' : 'bg-white/50'"
              class="w-2 h-2 rounded-full transition-colors"
            ></button>
          </div>
        </div>

        <!-- Image Counter -->
        <div class="p-4 bg-gray-50 border-t border-gray-200 rounded-b-2xl">
          <p class="text-sm text-gray-600 text-center">
            Image {{ currentImageIndex + 1 }} of {{ selectedRoomImages.length }}
          </p>
        </div>
      </div>
    </div>

    <!-- Room Details Modal -->
    <div
      *ngIf="showRoomDetailsModal"
      class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 animate-fade-in p-4 overflow-y-auto"
      (click)="closeRoomDetailsModal()"
    >
      <div
        class="bg-white rounded-2xl shadow-2xl max-w-5xl w-full mx-4 my-8 animate-scale-in max-h-[90vh] overflow-y-auto"
        (click)="$event.stopPropagation()"
      >
        <!-- Modal Header -->
        <div class="sticky top-0 bg-white border-b border-gray-200 p-6 flex justify-between items-center z-10">
          <h3 class="text-2xl font-bold text-gray-900">Room Details</h3>
          <button
            (click)="closeRoomDetailsModal()"
            class="text-gray-400 hover:text-gray-600 transition-colors"
          >
            <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>

        <!-- Loading State -->
        <div *ngIf="isLoadingRoomDetails" class="p-12 text-center">
          <div class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-gray-700"></div>
          <p class="mt-4 text-gray-500">Loading room details...</p>
        </div>

        <!-- Room Details Content -->
        <div *ngIf="!isLoadingRoomDetails && roomDetails" class="p-6 space-y-6">
          <!-- Room Images Slider -->
          <div class="bg-white rounded-2xl shadow-xl overflow-hidden">
            <div class="p-4 border-b border-gray-200">
              <h4 class="text-xl font-bold text-gray-900">Room Images</h4>
            </div>
            <div class="relative">
              <!-- Images Slider -->
              <div *ngIf="roomDetails.images && isArray(roomDetails.images) && roomDetails.images.length > 0" class="overflow-hidden">
                <div class="flex transition-transform duration-500 ease-in-out" [style.transform]="'translateX(-' + (roomDetailsImageIndex * 100) + '%)'">
                  <div *ngFor="let image of roomDetails.images" class="min-w-full">
                    <img 
                      [src]="getImageUrl(image)" 
                      [alt]="'Room ' + roomDetails.roomNumber" 
                      class="w-full h-96 object-contain bg-gray-50"
                      (error)="onImageError($event)"
                    >
                  </div>
                </div>
              </div>
              <!-- Placeholder when no images -->
              <div *ngIf="!roomDetails.images || !isArray(roomDetails.images) || roomDetails.images.length === 0" class="h-96 bg-gray-100 flex items-center justify-center">
                <div class="text-center">
                  <svg class="w-24 h-24 mx-auto text-gray-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                  </svg>
                  <p class="text-gray-500 text-lg font-semibold">No Images Available</p>
                </div>
              </div>
              <!-- Navigation Arrows -->
              <button
                *ngIf="roomDetails.images && isArray(roomDetails.images) && roomDetails.images.length > 1"
                (click)="prevRoomImage()"
                class="absolute left-4 top-1/2 transform -translate-y-1/2 bg-black/50 hover:bg-black/70 text-white p-2 rounded-full transition-colors z-10"
              >
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
              </button>
              <button
                *ngIf="roomDetails.images && isArray(roomDetails.images) && roomDetails.images.length > 1"
                (click)="nextRoomImage()"
                class="absolute right-4 top-1/2 transform -translate-y-1/2 bg-black/50 hover:bg-black/70 text-white p-2 rounded-full transition-colors z-10"
              >
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
              </button>
              <!-- Image Indicators -->
              <div *ngIf="roomDetails.images && isArray(roomDetails.images) && roomDetails.images.length > 1" class="absolute bottom-4 left-1/2 transform -translate-x-1/2 flex gap-2 z-10">
                <button
                  *ngFor="let img of roomDetails.images; let i = index"
                  (click)="goToRoomImage(i)"
                  [ngClass]="i === roomDetailsImageIndex ? 'bg-white' : 'bg-white/50'"
                  class="w-2 h-2 rounded-full transition-colors"
                ></button>
              </div>
            </div>
          </div>

          <!-- Room Info Card -->
          <div class="bg-white rounded-2xl shadow-xl p-6">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div class="space-y-4">
                <div>
                  <label class="block text-sm font-bold text-gray-500 mb-1">Room Number</label>
                  <p class="text-2xl font-bold text-gray-900">{{ roomDetails.roomNumber }}</p>
                </div>
                <div *ngIf="roomDetails.buildingInfo">
                  <label class="block text-sm font-bold text-gray-500 mb-1">Building</label>
                  <p class="text-xl text-gray-900">{{ roomDetails.buildingInfo.name }}</p>
                </div>
                <div *ngIf="!roomDetails.buildingInfo">
                  <label class="block text-sm font-bold text-gray-500 mb-1">Building</label>
                  <p class="text-xl text-gray-400">Not specified</p>
                </div>
                <div *ngIf="roomDetails.floor">
                  <label class="block text-sm font-bold text-gray-500 mb-1">Floor</label>
                  <p class="text-xl text-gray-900">{{ roomDetails.floor }}</p>
                </div>
              </div>

              <div class="space-y-4">
                <div>
                  <label class="block text-sm font-bold text-gray-500 mb-1">Status</label>
                  <span
                    [class]="getStatusBadgeClass(roomDetails.status)"
                    class="inline-block px-4 py-2 rounded-full text-white font-bold"
                  >
                    {{ getStatusText(roomDetails.status) }}
                  </span>
                </div>
                <div>
                  <label class="block text-sm font-bold text-gray-500 mb-1">Total Beds</label>
                  <p class="text-2xl font-bold text-gray-900">{{ roomDetails.totalBeds }}</p>
                </div>
                <div>
                  <label class="block text-sm font-bold text-gray-500 mb-1">Available Beds</label>
                  <p class="text-2xl font-bold text-gray-700">{{ roomDetails.availableBeds }}</p>
                </div>
                <div>
                  <label class="block text-sm font-bold text-gray-500 mb-1">Room Type</label>
                  <p class="text-xl font-semibold text-gray-900">{{ getRoomTypeText(roomDetails.roomType) }}</p>
                </div>
                <div *ngIf="roomDetails.roomType === 'single' && roomDetails.roomPrice">
                  <label class="block text-sm font-bold text-gray-500 mb-1">Room Price</label>
                  <p class="text-xl font-bold text-blue-600">${{ roomDetails.roomPrice }}</p>
                </div>
                <div *ngIf="roomDetails.roomType === 'shared' && roomDetails.bedPrice">
                  <label class="block text-sm font-bold text-gray-500 mb-1">Bed Price</label>
                  <p class="text-xl font-bold text-blue-600">${{ roomDetails.bedPrice }}</p>
                </div>
              </div>
            </div>

            <div *ngIf="roomDetails.description" class="mt-6 pt-6 border-t border-gray-200">
              <label class="block text-sm font-bold text-gray-500 mb-2">Description</label>
              <p class="text-gray-700">{{ roomDetails.description }}</p>
            </div>

            <!-- Services -->
            <div *ngIf="roomDetails.services && roomDetails.services.length > 0" class="mt-6 pt-6 border-t border-gray-200">
              <label class="block text-sm font-bold text-gray-500 mb-3">Available Services</label>
              <div class="flex flex-wrap gap-2">
                <span
                  *ngFor="let service of roomDetails.services"
                  class="px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg text-sm font-medium"
                >
                  {{ service.name }}
                </span>
              </div>
            </div>
          </div>

          <!-- Students in Room -->
          <div class="bg-white rounded-2xl shadow-xl p-6">
            <h4 class="text-xl font-bold text-gray-900 mb-4">Students in Room</h4>
            <div *ngIf="roomStudents.length === 0" class="text-center py-8">
              <p class="text-gray-500">No students currently in this room</p>
            </div>
            <div *ngIf="roomStudents.length > 0" class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div
                *ngFor="let roomStudent of roomStudents"
                class="bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-4 border border-gray-300"
              >
                <div class="flex justify-between items-start mb-3">
                  <div>
                    <h5 class="font-bold text-gray-900">{{ roomStudent.student?.name || 'Unknown' }}</h5>
                    <p class="text-sm text-gray-600">{{ roomStudent.student?.email || '' }}</p>
                    <ng-container *ngIf="roomStudent.student && roomStudent.student.college as college">
                      <p class="text-sm text-gray-600">
                        {{ college.name }}
                        <span *ngIf="roomStudent.student?.year"> - Year {{ roomStudent.student.year }}</span>
                      </p>
                    </ng-container>
                  </div>
                </div>
                <div class="text-xs text-gray-500">
                  <p>Check-in Date: {{ roomStudent.checkInDate | date: 'yyyy-MM-dd' }}</p>
                  <p *ngIf="roomStudent.checkOutDate">Check-out Date: {{ roomStudent.checkOutDate | date: 'yyyy-MM-dd' }}</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</app-layout>



